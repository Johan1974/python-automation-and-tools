name: Python Auto File Organizer CI

on:
push:
paths:
- 'python-auto-file-organizer/**'
- '.github/workflows/python_auto_file_organizer_ci.yml'
pull_request:
paths:
- 'python-auto-file-organizer/**'
- '.github/workflows/python_auto_file_organizer_ci.yml'

jobs:
test:
strategy:
matrix:
os: [ubuntu-latest, windows-latest, macos-latest]
runs-on: ${{ matrix.os }}

steps:
  # Checkout repo
  - name: Check out repository
    uses: actions/checkout@v4

  # Set up Python
  - name: Set up Python
    uses: actions/setup-python@v5
    with:
      python-version: "3.11"

  # Install dependencies (placeholder)
  - name: Install dependencies
    run: |
      python -m pip install --upgrade pip
      pip install pytest

  # Create a temporary test folder for safe testing
  - name: Create temp test folder
    run: |
      mkdir -p temp_test_folder
      cp -r python-auto-file-organizer/test_folder/* temp_test_folder/

  # Dry-run test: ensure files remain in place
  - name: Dry-run organize (extension mode)
    run: |
      python python-auto-file-organizer/auto_cleanup.py -s temp_test_folder --mode extension --dry-run

  # Run organize by extension (actual move)
  - name: Organize by extension
    run: |
      python python-auto-file-organizer/auto_cleanup.py -s temp_test_folder --mode extension

  # Reset temp folder to original state
  - name: Reset temp test folder
    run: |
      python python-auto-file-organizer/auto_cleanup.py -s temp_test_folder --reset

  # Run organize by date (actual move)
  - name: Organize by date
    run: |
      python python-auto-file-organizer/auto_cleanup.py -s temp_test_folder --mode date

  # Final clean up
  - name: Remove temp test folder
    run: |
      rm -rf temp_test_folder
